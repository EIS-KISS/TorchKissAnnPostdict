# TorchKissAnn

_TorchKissAnn_ is a collection of tools to train and validate various machine learning algorithms on EIS data.

## Componants

_TorchKissAnn_ contains the following tools:

1. torchkissann_train
	* trains machine learning models on EIS datasets
2. torchkissann_test
	* tests and validates the models created by _train
3. torchkissann
	* alows use of the models trained by _train
4. torchkissann_datasetinfo
	* visualizes datasets 
5. torchkissann_tune
	* Tunes hyperparameters

### torchkissann_train

_torchkissann_train_ takes datasets created by [KissDatasetGenerator](https://github.com/EIS-KISS/KissDatasetGenerator) and trains those on the methods specified by the `--model` option.
In most cases the model takes a parameter via the `--network` option that gives the path to a [TorchScript](https://pytorch.org/tutorials/beginner/Intro_to_TorchScript_tutorial.html) file that contains the network architecture to train. These _TorchScript_ files are in turn generated by _buildnet.py_ script in the scripts directory of this repo.

After a run _torchkissann_train_ will have created a runs directory in which you can find graphs, metrics, checkpoints and networks.
The _onnxexport.py_ script can then be used to export the created networks to onnx to be used by _libkissinference_.

### torchkissann_test

_torchkissann_test_ tests the methods trained by _torchkissann_train_. Using the `--input-importance` _torchkissann_test_ can also determine the feature importance of a given networks inputs on the dataset supplied to _torchkissann_test_.

Like _torchkissann_train_ _torchkissann_test_ takes datasets in the formats cerated by [KissDatasetGenerator](https://github.com/EIS-KISS/KissDatasetGenerator).

## Building

### Requirements

_TorchKissAnn_ only runs on linux. To build and use _TorchKissAnn_ you must have the following.

* cmake
* a c++17 compiler like GCC
* pkg-config
* [jsoncpp](https://github.com/open-source-parsers/jsoncpp)
* [sciplot](https://github.com/sciplot/sciplot) is optional and used to output pretty graphs
* [eisgenerator](https://github.com/EIS-KISS/eisgenerator)
* [eistype](https://github.com/EIS-KISS/Eistype)

Building _TorchKissAnn_ is a memory intensive task, it is recommended to have at least 16GB of system ram.

### Procedure

To build TorchKissAnn do the following:

```
$ git clone THIS_REPO torchkissann
$ mkdir build
$ cd build
$ cmake ..
$ make
```

Binaries will be in the folders of build/src/*
